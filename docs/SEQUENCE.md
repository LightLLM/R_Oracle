# R-Oracle Sequence Diagram

## Oracle Update Flow

```
User          Frontend         RPC Layer        Parachain      Oracle APIs
 │                │                │                │              │
 │  Click Submit  │                │                │              │
 ├───────────────>│                │                │              │
 │                │                │                │              │
 │                │  Fetch Price   │                │              │
 │                ├───────────────────────────────────────────────>│
 │                │                │                │              │
 │                │                │                │    (Binance fails)
 │                │                │                │              │
 │                │  Try Coinbase  │                │              │
 │                ├───────────────────────────────────────────────>│
 │                │                │                │              │
 │                │  Price: $50k   │                │              │
 │                │<───────────────────────────────────────────────┤
 │                │                │                │              │
 │                │  Connect RPC   │                │              │
 │                ├───────────────>│                │              │
 │                │                │                │              │
 │                │  (Primary fails)                │              │
 │                │                │                │              │
 │                │  Try Fallback  │                │              │
 │                ├───────────────>│                │              │
 │                │                │                │              │
 │                │  Connected     │                │              │
 │                │<───────────────┤                │              │
 │                │                │                │              │
 │                │  Submit TX     │                │              │
 │                ├───────────────>│                │              │
 │                │                │  submit_oracle_value          │
 │                │                ├───────────────>│              │
 │                │                │                │              │
 │                │                │  Validate      │              │
 │                │                │<───────────────┤              │
 │                │                │                │              │
 │                │                │  Store Data    │              │
 │                │                │<───────────────┤              │
 │                │                │                │              │
 │                │                │  Event: ValueUpdated          │
 │                │                │<───────────────┤              │
 │                │                │                │              │
 │                │  TX Confirmed  │                │              │
 │                │<───────────────┤                │              │
 │                │                │                │              │
 │                │  Query Data    │                │              │
 │                ├───────────────>│                │              │
 │                │                │  Query Storage │              │
 │                │                ├───────────────>│              │
 │                │                │                │              │
 │                │                │  Return Data   │              │
 │                │                │<───────────────┤              │
 │                │  Update UI     │                │              │
 │<───────────────┤                │                │              │
 │                │                │                │              │
```

## RPC Failover Flow

```
Frontend         Primary RPC      Fallback RPC
   │                 │                 │
   │  Connect        │                 │
   ├────────────────>│                 │
   │                 │                 │
   │  (Timeout)      │                 │
   │                 │                 │
   │  Health Check   │                 │
   ├────────────────>│                 │
   │                 │                 │
   │  (Failed)       │                 │
   │<────────────────┤                 │
   │                 │                 │
   │  Connect        │                 │
   │──────────────────────────────────>│
   │                 │                 │
   │  Connected      │                 │
   │<──────────────────────────────────┤
   │                 │                 │
```

## Oracle Source Failover Flow

```
Frontend         Binance          Coinbase         Kraken
   │                 │                 │              │
   │  Fetch Price    │                 │              │
   ├────────────────>│                 │              │
   │                 │                 │              │
   │  (Error)        │                 │              │
   │<────────────────┤                 │              │
   │                 │                 │              │
   │  Fetch Price    │                 │              │
   ├──────────────────────────────────>│              │
   │                 │                 │              │
   │  (Error)        │                 │              │
   │<──────────────────────────────────┤              │
   │                 │                 │              │
   │  Fetch Price    │                 │              │
   ├─────────────────────────────────────────────────>│
   │                 │                 │              │
   │  Price: $50k    │                 │              │
   │<─────────────────────────────────────────────────┤
   │                 │                 │              │
```

